<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Finishing sign in...</title>
  <style> body { font-family: system-ui, Arial; max-width: 720px; margin: 24px auto; padding: 16px; } </style>
</head>
<body
  data-supabase-url="PASTE_YOUR_SUPABASE_URL_HERE"
  data-supabase-anon-key="PASTE_YOUR_SUPABASE_ANON_KEY_HERE"
>
  <h1>Finishing sign in</h1>
  <p id="msg">Checking the link...</p>
  <p><a href="./app.html">Go to protected page</a></p>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const body = document.body;
    const SUPABASE_URL = body.dataset.supabaseUrl;
    const SUPABASE_ANON_KEY = body.dataset.supabaseAnonKey;
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    (async () => {
      const out = await supabase.auth.exchangeCodeForSession(window.location.href);
      if (out.error) {
        document.getElementById('msg').textContent = out.error.message;
      } else {
        document.getElementById('msg').textContent = 'Signed in. You can open the protected page.';
      }
    })();
  </script>
</body>
</html>